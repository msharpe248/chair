<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Chair Conformation Viewer</title>
  <link rel="stylesheet" href="css/styles.css">
</head>
<body>
  <header>
    <div class="viewer-selector">
      <select id="viewer-select">
        <option value="chair">Chair Conformation Viewer</option>
        <option value="energy">Reaction Energy Diagram</option>
        <option value="e2">E2 Stereochemistry</option>
        <option value="alkene">Alkene Stability</option>
        <option value="stereo">Stereochemistry Tracker</option>
        <option value="mechanism">Mechanism Animator</option>
      </select>
    </div>
    <nav id="chair-mode-selector" class="mode-selector">
      <button class="mode-btn active" data-mode="cyclohexane">Cyclohexane</button>
      <button class="mode-btn" data-mode="pyranose">Sugar</button>
      <button class="mode-btn" data-mode="decalin">Decalin</button>
    </nav>
    <a href="docs/index.html" class="help-link" title="Documentation">? Help</a>
    <button id="theme-toggle-btn" class="theme-toggle" title="Toggle dark mode">
      <span class="theme-icon light">‚òÄÔ∏è</span>
      <span class="theme-icon dark">üåô</span>
    </button>
    <button id="quiz-mode-btn" class="quiz-btn chair-only">Quiz Mode</button>
    <button id="energy-quiz-mode-btn" class="quiz-btn energy-only hidden">Quiz Mode</button>
    <button id="alkene-quiz-mode-btn" class="quiz-btn alkene-only hidden">Quiz Mode</button>
    <button id="stereo-quiz-mode-btn" class="quiz-btn stereo-only hidden">Quiz Mode</button>
    <button id="mechanism-quiz-mode-btn" class="quiz-btn mechanism-only hidden">Quiz Mode</button>
  </header>

  <main>
    <section class="viewer-section">
      <!-- Mode-specific controls -->
      <div id="cyclohexane-controls" class="mode-controls">
        <div class="view-toggle">
          <button class="view-btn active" data-view="chair">Chair View</button>
          <button class="view-btn" data-view="newman">Newman Projection</button>
          <select id="newman-bond-select" class="newman-bond-select hidden">
            <option value="0">C1‚ÄìC2</option>
            <option value="1">C2‚ÄìC3</option>
            <option value="2">C3‚ÄìC4</option>
            <option value="3">C4‚ÄìC5</option>
            <option value="4">C5‚ÄìC6</option>
            <option value="5">C6‚ÄìC1</option>
          </select>
        </div>
        <div class="control-row smiles-input-row">
          <label for="smiles-input">SMILES:</label>
          <input type="text" id="smiles-input" placeholder="e.g., CC1CCCCC1" class="smiles-input">
          <button id="parse-smiles-btn" class="small-btn">Load</button>
        </div>
        <div id="smiles-error" class="smiles-error hidden"></div>
        <div class="control-row">
          <label for="preset-select">Example:</label>
          <select id="preset-select">
            <option value="">‚Äî Select a preset ‚Äî</option>
            <optgroup label="Single Substituent">
              <option value="methyl-ax">Methylcyclohexane (axial)</option>
              <option value="methyl-eq">Methylcyclohexane (equatorial)</option>
              <option value="tbutyl-eq">tert-Butylcyclohexane</option>
            </optgroup>
            <optgroup label="1,2-Disubstituted">
              <option value="1,2-dimethyl-cis">1,2-Dimethyl (cis)</option>
              <option value="1,2-dimethyl-trans">1,2-Dimethyl (trans)</option>
            </optgroup>
            <optgroup label="1,3-Disubstituted">
              <option value="1,3-dimethyl-cis">1,3-Dimethyl (cis)</option>
              <option value="1,3-dimethyl-trans">1,3-Dimethyl (trans)</option>
            </optgroup>
            <optgroup label="1,4-Disubstituted">
              <option value="1,4-dimethyl-cis">1,4-Dimethyl (cis)</option>
              <option value="1,4-dimethyl-trans">1,4-Dimethyl (trans)</option>
            </optgroup>
            <optgroup label="Complex Examples">
              <option value="menthol">Menthol-like (1,2,4-trisubstituted)</option>
              <option value="all-axial">All Axial Methyl Groups</option>
              <option value="all-equatorial">All Equatorial Methyl Groups</option>
            </optgroup>
          </select>
        </div>
      </div>

      <div id="pyranose-controls" class="mode-controls hidden">
        <div class="control-row">
          <label for="sugar-select">Sugar:</label>
          <select id="sugar-select">
            <option value="glucose">D-Glucose</option>
            <option value="galactose">D-Galactose</option>
            <option value="mannose">D-Mannose</option>
            <option value="allose">D-Allose</option>
            <option value="altrose">D-Altrose</option>
            <option value="gulose">D-Gulose</option>
            <option value="idose">D-Idose</option>
            <option value="talose">D-Talose</option>
          </select>
        </div>
        <div class="control-row">
          <label>Anomer:</label>
          <div class="anomer-toggle">
            <button id="alpha-btn" class="anomer-btn">Œ± (alpha)</button>
            <button id="beta-btn" class="anomer-btn selected">Œ≤ (beta)</button>
          </div>
        </div>
      </div>

      <div id="decalin-controls" class="mode-controls hidden">
        <div class="control-row">
          <label>Type:</label>
          <div class="decalin-toggle">
            <button id="trans-btn" class="decalin-btn selected">trans</button>
            <button id="cis-btn" class="decalin-btn">cis</button>
          </div>
        </div>
        <div id="decalin-info" class="info-text">
          Bridgehead H's on opposite faces. Rigid - cannot ring flip.
        </div>
      </div>

      <!-- Energy Diagram Controls (hidden by default) -->
      <div id="energy-controls" class="mode-controls hidden">
        <div class="energy-mode-toggle">
          <button class="energy-mode-btn active" data-mode="predict">Conditions</button>
          <button class="energy-mode-btn" data-mode="smiles">SMILES</button>
          <button class="energy-mode-btn" data-mode="preset">Preset</button>
        </div>

        <!-- Prediction Mode Controls -->
        <div id="predict-controls" class="energy-subcontrols">
          <div class="condition-grid">
            <div class="condition-item">
              <label for="substrate-select">Substrate:</label>
              <select id="substrate-select">
                <option value="methyl">Methyl (CH‚ÇÉ-X)</option>
                <option value="primary">1¬∞ Primary</option>
                <option value="secondary" selected>2¬∞ Secondary</option>
                <option value="tertiary">3¬∞ Tertiary</option>
                <option value="allylic">Allylic</option>
                <option value="benzylic">Benzylic</option>
                <option value="vinyl">Vinyl/Aryl</option>
              </select>
            </div>
            <div class="condition-item">
              <label for="nucleophile-select">Nucleophile/Base:</label>
              <select id="nucleophile-select">
                <option value="strong_small">Strong, small (CN‚Åª, I‚Åª)</option>
                <option value="strong_normal" selected>Strong (OH‚Åª, RO‚Åª)</option>
                <option value="strong_bulky">Strong, bulky (tBuO‚Åª)</option>
                <option value="weak">Weak (H‚ÇÇO, ROH)</option>
                <option value="none">None / Very weak</option>
              </select>
            </div>
            <div class="condition-item">
              <label for="leaving-group-select">Leaving Group:</label>
              <select id="leaving-group-select">
                <option value="excellent">Excellent (OTs, I‚Åª)</option>
                <option value="good" selected>Good (Br‚Åª, Cl‚Åª)</option>
                <option value="moderate">Moderate (F‚Åª)</option>
                <option value="poor">Poor (OH, NH‚ÇÇ)</option>
              </select>
            </div>
            <div class="condition-item">
              <label for="solvent-select">Solvent:</label>
              <select id="solvent-select">
                <option value="polar_aprotic">Polar aprotic (DMSO)</option>
                <option value="polar_protic" selected>Polar protic (EtOH)</option>
                <option value="nonpolar">Nonpolar (hexane)</option>
              </select>
            </div>
            <div class="condition-item">
              <label for="temperature-select">Temperature:</label>
              <select id="temperature-select">
                <option value="low">Low (&lt; 0¬∞C)</option>
                <option value="room" selected>Room temp</option>
                <option value="elevated">Elevated (50-80¬∞C)</option>
                <option value="high">High (&gt; 100¬∞C)</option>
              </select>
            </div>
          </div>
          <div class="control-row energy-buttons">
            <button id="predict-btn" class="primary-btn">Predict Mechanism</button>
            <button id="show-competing-btn" class="small-btn">Show All Competing</button>
          </div>
        </div>

        <!-- SMILES Mode Controls -->
        <div id="smiles-controls" class="energy-subcontrols hidden">
          <div class="smiles-reaction-input">
            <div class="smiles-row">
              <label for="reactant-smiles">Reactant:</label>
              <input type="text" id="reactant-smiles" placeholder="e.g., CCBr" class="smiles-input">
            </div>
            <div class="smiles-arrow">‚Üí</div>
            <div class="smiles-row">
              <label for="product-smiles">Product:</label>
              <input type="text" id="product-smiles" placeholder="e.g., CCO" class="smiles-input">
            </div>
          </div>
          <div class="smiles-examples">
            <label>Examples:</label>
            <select id="smiles-example-select">
              <option value="">‚Äî Select example ‚Äî</option>
              <option value="sn2">SN2: CCBr ‚Üí CCO</option>
              <option value="sn1">SN1: CC(C)(C)Br ‚Üí CC(C)(C)O</option>
              <option value="e2">E2: CC(Br)C ‚Üí CC=C</option>
              <option value="hydro">Hydrogenation: CC=CC ‚Üí CCCC</option>
            </select>
          </div>
          <div class="control-row energy-buttons">
            <button id="analyze-smiles-btn" class="primary-btn">Analyze Reaction</button>
          </div>
          <div id="smiles-analysis" class="smiles-analysis hidden">
            <div class="analysis-row">
              <span>Reaction Type:</span>
              <span id="smiles-reaction-type">‚Äî</span>
            </div>
            <div class="analysis-row">
              <span>Bonds Broken:</span>
              <span id="smiles-bonds-broken">‚Äî</span>
            </div>
            <div class="analysis-row">
              <span>Bonds Formed:</span>
              <span id="smiles-bonds-formed">‚Äî</span>
            </div>
            <div class="analysis-row highlight">
              <span>Est. ŒîH:</span>
              <span id="smiles-delta-h">‚Äî</span>
            </div>
          </div>
        </div>

        <!-- Preset Mode Controls -->
        <div id="preset-controls" class="energy-subcontrols hidden">
          <div class="control-row">
            <label for="reaction-preset">Reaction:</label>
            <select id="reaction-preset">
              <option value="sn2">SN2 (concerted)</option>
              <option value="sn1">SN1 (2-step)</option>
              <option value="e2">E2 (concerted)</option>
              <option value="e1">E1 (2-step)</option>
              <option value="hydrogenation">Hydrogenation</option>
              <option value="exothermic">Exothermic (generic)</option>
              <option value="endothermic">Endothermic (generic)</option>
              <option value="custom">Custom (adjustable)</option>
            </select>
          </div>

          <!-- Custom Energy Sliders -->
          <div id="custom-energy-controls" class="custom-energy-controls hidden">
            <div class="slider-row">
              <label for="ea-slider">Activation Energy (Ea):</label>
              <input type="range" id="ea-slider" min="5" max="40" value="15" step="1">
              <span id="ea-value" class="slider-value">15 kcal/mol</span>
            </div>
            <div class="slider-row">
              <label for="delta-h-slider">ŒîH (Product Energy):</label>
              <input type="range" id="delta-h-slider" min="-30" max="20" value="-5" step="1">
              <span id="delta-h-value" class="slider-value">-5 kcal/mol</span>
            </div>
            <div class="slider-row">
              <label>
                <input type="checkbox" id="two-step-checkbox">
                Two-step mechanism
              </label>
            </div>
            <div id="step2-controls" class="step2-controls hidden">
              <div class="slider-row">
                <label for="int-slider">Intermediate Energy:</label>
                <input type="range" id="int-slider" min="0" max="25" value="12" step="1">
                <span id="int-value" class="slider-value">12 kcal/mol</span>
              </div>
              <div class="slider-row">
                <label for="ea2-slider">Second Ea:</label>
                <input type="range" id="ea2-slider" min="2" max="20" value="5" step="1">
                <span id="ea2-value" class="slider-value">5 kcal/mol</span>
              </div>
            </div>
            <p class="drag-hint">Tip: Drag points on the diagram to adjust values</p>
          </div>

          <div class="control-row energy-buttons">
            <button id="add-curve-btn" class="small-btn">+ Add Curve</button>
            <button id="clear-curves-btn" class="small-btn">Clear All</button>
          </div>
        </div>
      </div>

      <!-- E2 Stereochemistry Controls (hidden by default) -->
      <div id="e2-controls" class="mode-controls hidden">
        <div class="control-row">
          <label for="e2-substrate-select">Substrate:</label>
          <select id="e2-substrate-select">
            <option value="2-bromobutane">2-Bromobutane</option>
            <option value="2-bromopentane">2-Bromopentane</option>
            <option value="cyclohexyl-bromide">Bromocyclohexane</option>
            <option value="menthyl-chloride">Menthyl chloride</option>
            <option value="neomenthyl-chloride">Neomenthyl chloride</option>
          </select>
        </div>
        <div class="control-row">
          <label for="e2-base-select">Base:</label>
          <select id="e2-base-select">
            <option value="NaOEt">NaOEt (non-bulky)</option>
            <option value="NaOH">NaOH (non-bulky)</option>
            <option value="tBuOK">t-BuOK (bulky)</option>
            <option value="DBU">DBU (bulky)</option>
            <option value="LDA">LDA (bulky)</option>
          </select>
        </div>
        <div class="control-row">
          <label for="e2-view-select">View:</label>
          <select id="e2-view-select">
            <option value="newman">Newman Projection</option>
            <option value="chair">Chair Conformation</option>
          </select>
        </div>
        <div class="control-row">
          <label>
            <input type="checkbox" id="e2-show-anti" checked>
            Highlight anti-periplanar H
          </label>
        </div>
        <div class="control-row energy-buttons">
          <button id="e2-analyze-btn" class="primary-btn">Analyze E2</button>
        </div>
      </div>

      <!-- Alkene Stability Controls (hidden by default) -->
      <div id="alkene-controls" class="mode-controls hidden">
        <div class="control-row">
          <label for="alkene-comparison-set">Compare:</label>
          <select id="alkene-comparison-set">
            <option value="butene-isomers">Butene Isomers (C‚ÇÑH‚Çà)</option>
            <option value="substitution-effect">Substitution Effect</option>
            <option value="cis-trans">Cis vs Trans (E/Z)</option>
            <option value="pentene-isomers">Pentene Isomers (C‚ÇÖH‚ÇÅ‚ÇÄ)</option>
            <option value="cyclic">Cyclic Alkenes</option>
            <option value="custom">Custom Selection</option>
          </select>
        </div>
        <div id="alkene-custom-select" class="alkene-custom-select hidden">
          <label>Select alkenes:</label>
          <div class="alkene-checkboxes">
            <label><input type="checkbox" value="ethene"> Ethene</label>
            <label><input type="checkbox" value="propene"> Propene</label>
            <label><input type="checkbox" value="1-butene"> 1-Butene</label>
            <label><input type="checkbox" value="cis-2-butene"> cis-2-Butene</label>
            <label><input type="checkbox" value="trans-2-butene"> trans-2-Butene</label>
            <label><input type="checkbox" value="isobutylene"> Isobutylene</label>
            <label><input type="checkbox" value="2-methyl-2-butene"> 2-Methyl-2-butene</label>
            <label><input type="checkbox" value="2,3-dimethyl-2-butene"> 2,3-Dimethyl-2-butene</label>
            <label><input type="checkbox" value="cyclohexene"> Cyclohexene</label>
            <label><input type="checkbox" value="1-methylcyclohexene"> 1-Methylcyclohexene</label>
          </div>
        </div>
        <div class="smiles-input-section">
          <label for="alkene-smiles-input">Analyze your alkene (SMILES):</label>
          <div class="smiles-input-row">
            <input type="text" id="alkene-smiles-input" placeholder="e.g., CC=CC or C/C=C/C" spellcheck="false">
            <button id="alkene-analyze-btn" class="primary-btn">Analyze</button>
          </div>
          <div class="smiles-examples">
            <span>Examples:</span>
            <button class="example-btn" data-smiles="C=C">ethene</button>
            <button class="example-btn" data-smiles="CC=C">propene</button>
            <button class="example-btn" data-smiles="C/C=C/C">trans-2-butene</button>
            <button class="example-btn" data-smiles="C/C=C\C">cis-2-butene</button>
            <button class="example-btn" data-smiles="CC(C)=C">isobutylene</button>
          </div>
        </div>
        <div class="alkene-view-toggle">
          <button class="alkene-view-btn active" data-view="comparison">Bar Chart</button>
          <button class="alkene-view-btn" data-view="energy">Energy Diagram</button>
        </div>
        <div class="control-row">
          <label>
            <input type="checkbox" id="alkene-highlight-most" checked>
            Highlight most stable
          </label>
        </div>
      </div>

      <!-- Stereochemistry Tracker Controls (hidden by default) -->
      <div id="stereo-controls" class="mode-controls hidden">
        <div class="control-row">
          <label for="stereo-mode-select">Mode:</label>
          <select id="stereo-mode-select">
            <option value="sn2">SN2 Inversion</option>
            <option value="sn1">SN1 Racemization</option>
            <option value="enantiomers">Enantiomers</option>
            <option value="diastereomers">Diastereomers</option>
          </select>
        </div>
        <div id="stereo-molecule-row" class="control-row">
          <label for="stereo-molecule-select">Substrate:</label>
          <select id="stereo-molecule-select">
            <option value="2-bromobutane-r">(R)-2-Bromobutane</option>
            <option value="2-bromobutane-s">(S)-2-Bromobutane</option>
            <option value="2-chlorobutane-r">(R)-2-Chlorobutane</option>
            <option value="lactic-acid-r">(R)-Lactic Acid</option>
            <option value="lactic-acid-s">(S)-Lactic Acid</option>
          </select>
        </div>
        <div id="stereo-config-row" class="control-row">
          <label>Start Config:</label>
          <div class="config-toggle">
            <button class="config-btn selected" data-config="R">(R)</button>
            <button class="config-btn" data-config="S">(S)</button>
          </div>
        </div>
        <div class="smiles-input-section">
          <label for="stereo-smiles-input">Analyze your molecule (SMILES):</label>
          <div class="smiles-input-row">
            <input type="text" id="stereo-smiles-input" placeholder="e.g., CC[C@@H](Br)C" spellcheck="false">
            <button id="stereo-analyze-btn" class="primary-btn">Analyze</button>
          </div>
          <div class="smiles-examples">
            <span>Examples:</span>
            <button class="example-btn" data-smiles="CC[C@@H](Br)C">(R)-2-bromobutane</button>
            <button class="example-btn" data-smiles="CC[C@H](Br)C">(S)-2-bromobutane</button>
            <button class="example-btn" data-smiles="C[C@@H](O)C(=O)O">(R)-lactic acid</button>
            <button class="example-btn" data-smiles="C[C@H](N)C(=O)O">L-alanine</button>
          </div>
        </div>
      </div>

      <!-- Mechanism Animator Controls (hidden by default) -->
      <div id="mechanism-controls" class="mode-controls hidden">
        <div class="control-row">
          <label for="mechanism-type-select">Reaction Type:</label>
          <select id="mechanism-type-select">
            <optgroup label="Substitution">
              <option value="sn2">SN2 (Bimolecular)</option>
              <option value="sn1">SN1 (Unimolecular)</option>
            </optgroup>
            <optgroup label="Elimination">
              <option value="e2">E2 (Bimolecular)</option>
              <option value="e1">E1 (Unimolecular)</option>
            </optgroup>
            <optgroup label="Addition">
              <option value="addition-hbr">HBr Addition</option>
              <option value="addition-br2">Br‚ÇÇ Addition</option>
            </optgroup>
          </select>
        </div>
        <div class="control-row mechanism-step-controls">
          <label>Step:</label>
          <div class="step-navigation">
            <button id="mechanism-prev-btn" class="step-btn" disabled>‚óÄ Prev</button>
            <span id="mechanism-step-indicator">1 / 1</span>
            <button id="mechanism-next-btn" class="step-btn">Next ‚ñ∂</button>
          </div>
        </div>
        <div class="control-row">
          <label>
            <input type="checkbox" id="mechanism-show-arrows" checked>
            Show electron flow arrows
          </label>
        </div>
      </div>

      <div class="chair-container" id="chair-container">
        <div class="svg-wrapper" id="svg-wrapper">
          <svg id="chair-svg" viewBox="0 0 400 350"></svg>
        </div>
      </div>
      <div class="canvas-controls">
        <div class="zoom-controls">
          <button id="zoom-out-btn" title="Zoom Out">‚àí</button>
          <span id="zoom-level">100%</span>
          <button id="zoom-in-btn" title="Zoom In">+</button>
          <button id="zoom-reset-btn" title="Reset Zoom">‚Ü∫</button>
        </div>
        <div class="rotation-controls chair-only">
          <label class="checkbox-label">
            <input type="checkbox" id="enable-3d">
            3D
          </label>
          <input type="range" id="rotate-x" min="-60" max="60" value="0" class="rotation-slider hidden" title="Rotate X">
          <input type="range" id="rotate-y" min="-60" max="60" value="0" class="rotation-slider hidden" title="Rotate Y">
          <button id="reset-rotation-btn" class="hidden" title="Reset Rotation">‚Ü∫</button>
        </div>
        <div class="export-controls">
          <button id="export-png-btn" title="Export as PNG">üì∑ PNG</button>
          <button id="export-svg-btn" title="Export as SVG">üìÑ SVG</button>
        </div>
      </div>
      <div class="controls chair-only">
        <button id="flip-btn">Ring Flip</button>
        <button id="reset-btn">Reset</button>
        <label class="checkbox-label">
          <input type="checkbox" id="show-labels" checked>
          Show Ax/Eq Labels
        </label>
        <label class="checkbox-label">
          <input type="checkbox" id="show-interactions">
          Show 1,3-Diaxial
        </label>
      </div>
    </section>

    <aside class="info-panel">
      <!-- Quiz Panel (shown when quiz mode active) -->
      <div id="quiz-panel" class="quiz-panel hidden">
        <div class="quiz-header">
          <h3>Practice Quiz</h3>
          <div class="quiz-score">Score: <span id="quiz-score">0/0</span></div>
        </div>
        <div class="quiz-difficulty">
          <button class="difficulty-btn selected" data-level="1">Easy</button>
          <button class="difficulty-btn" data-level="2">Medium</button>
          <button class="difficulty-btn" data-level="3">Hard</button>
        </div>
        <div class="quiz-question-area">
          <p id="quiz-question" class="quiz-question">Click "New Question" to start!</p>
          <div id="quiz-options" class="quiz-options"></div>
          <div id="quiz-feedback" class="quiz-feedback hidden"></div>
        </div>
        <div class="quiz-actions">
          <button id="new-question-btn" class="primary-btn">New Question</button>
          <button id="submit-answer-btn" class="primary-btn" disabled>Submit</button>
          <button id="reset-quiz-btn" class="secondary-btn">Reset</button>
        </div>
      </div>

      <!-- Energy Diagram Info Panel (for reaction energy viewer) -->
      <div id="reaction-energy-panel" class="energy-display hidden">
        <h3>Mechanism Prediction</h3>

        <!-- Prediction Result -->
        <div id="prediction-result" class="prediction-result">
          <div class="prediction-header">
            <span class="predicted-mechanism" id="predicted-mechanism">‚Äî</span>
            <span class="prediction-confidence" id="prediction-confidence"></span>
          </div>
          <div id="mechanism-scores" class="mechanism-scores">
            <div class="score-bar-row">
              <span class="score-label">SN2</span>
              <div class="score-bar-container"><div class="score-bar" id="score-sn2"></div></div>
              <span class="score-value" id="score-sn2-val">0%</span>
            </div>
            <div class="score-bar-row">
              <span class="score-label">SN1</span>
              <div class="score-bar-container"><div class="score-bar" id="score-sn1"></div></div>
              <span class="score-value" id="score-sn1-val">0%</span>
            </div>
            <div class="score-bar-row">
              <span class="score-label">E2</span>
              <div class="score-bar-container"><div class="score-bar" id="score-e2"></div></div>
              <span class="score-value" id="score-e2-val">0%</span>
            </div>
            <div class="score-bar-row">
              <span class="score-label">E1</span>
              <div class="score-bar-container"><div class="score-bar" id="score-e1"></div></div>
              <span class="score-value" id="score-e1-val">0%</span>
            </div>
          </div>
        </div>

        <!-- Explanation -->
        <div id="prediction-explanation" class="prediction-explanation">
          <h4>Why this mechanism?</h4>
          <ul id="explanation-list" class="explanation-list">
            <li class="empty-message">Select conditions and click "Predict"</li>
          </ul>
        </div>

        <!-- Curve Details (for preset mode) -->
        <div id="curve-list" class="curve-list hidden">
        </div>

        <!-- Energy Quiz Panel -->
        <div id="energy-quiz-panel" class="energy-quiz-panel hidden">
          <div class="quiz-header">
            <h4>Energy Diagram Quiz</h4>
            <div class="quiz-score">Score: <span id="energy-quiz-score">0/0</span></div>
          </div>
          <div class="quiz-question-area">
            <p id="energy-quiz-question" class="quiz-question">Click "New Question" to start!</p>
            <div id="energy-quiz-options" class="quiz-options"></div>
            <div id="energy-quiz-feedback" class="quiz-feedback hidden"></div>
          </div>
          <div class="quiz-actions">
            <button id="energy-new-question-btn" class="primary-btn">New Question</button>
            <button id="energy-submit-btn" class="primary-btn" disabled>Submit</button>
          </div>
        </div>
      </div>

      <!-- E2 Stereochemistry Panel -->
      <div id="e2-panel" class="energy-display hidden">
        <h3>E2 Analysis</h3>

        <!-- Product Prediction -->
        <div id="e2-products" class="e2-products">
          <h4>Possible Products</h4>
          <div id="e2-product-list" class="e2-product-list">
            <p class="empty-message">Select substrate and click "Analyze E2"</p>
          </div>
        </div>

        <!-- Major Product -->
        <div id="e2-major-product" class="e2-major-product hidden">
          <div class="major-product-header">
            <span class="label">Major Product:</span>
            <span id="e2-major-name" class="product-name">‚Äî</span>
          </div>
          <div class="product-type">
            <span id="e2-product-type"></span>
          </div>
        </div>

        <!-- Explanation -->
        <div id="e2-explanation" class="e2-explanation">
          <h4>Key Concepts</h4>
          <ul id="e2-explanation-list" class="explanation-list">
            <li>E2 requires <strong>anti-periplanar</strong> geometry (180¬∞)</li>
            <li>H and leaving group must be on opposite sides</li>
            <li>Concerted mechanism - no carbocation intermediate</li>
          </ul>
        </div>

        <!-- Legend -->
        <div class="e2-legend">
          <h4>Newman Legend</h4>
          <div class="legend-item">
            <span class="legend-color anti"></span>
            <span>Anti-periplanar H (can eliminate)</span>
          </div>
          <div class="legend-item">
            <span class="legend-color gauche"></span>
            <span>Gauche H (cannot eliminate)</span>
          </div>
          <div class="legend-item">
            <span class="legend-color lg"></span>
            <span>Leaving group</span>
          </div>
        </div>

        <!-- E2 Quiz Panel -->
        <div id="e2-quiz-panel" class="energy-quiz-panel hidden">
          <div class="quiz-header">
            <h4>E2 Stereochemistry Quiz</h4>
            <div class="quiz-score">Score: <span id="e2-quiz-score">0/0</span></div>
          </div>
          <div class="quiz-question-area">
            <p id="e2-quiz-question" class="quiz-question">Click "New Question" to start!</p>
            <div id="e2-quiz-options" class="quiz-options"></div>
            <div id="e2-quiz-feedback" class="quiz-feedback hidden"></div>
          </div>
          <div class="quiz-actions">
            <button id="e2-new-question-btn" class="primary-btn">New Question</button>
            <button id="e2-submit-btn" class="primary-btn" disabled>Submit</button>
          </div>
        </div>
      </div>

      <!-- Alkene Stability Panel -->
      <div id="alkene-panel" class="energy-display hidden">
        <h3>Alkene Stability</h3>

        <!-- SMILES Analysis Result -->
        <div id="alkene-smiles-result" class="smiles-result hidden">
          <h4>Your Alkene Analysis</h4>
          <div class="smiles-result-content">
            <div class="info-row">
              <span>Structure:</span>
              <span id="alkene-result-smiles" class="mono">‚Äî</span>
            </div>
            <div class="info-row">
              <span>Classification:</span>
              <span id="alkene-result-class">‚Äî</span>
            </div>
            <div class="info-row">
              <span>Stereochemistry:</span>
              <span id="alkene-result-stereo">‚Äî</span>
            </div>
            <div class="info-row highlight">
              <span>Est. ŒîH (hydrogenation):</span>
              <span id="alkene-result-dh">‚Äî</span>
            </div>
            <div id="alkene-result-explanation" class="result-explanation"></div>
          </div>
        </div>

        <!-- Stability Ranking -->
        <div id="alkene-ranking" class="alkene-ranking">
          <h4>Stability Ranking</h4>
          <p class="ranking-subtitle">(Most to Least Stable)</p>
          <ol id="alkene-ranking-list" class="alkene-ranking-list">
            <li class="empty-message">Select a comparison set to begin</li>
          </ol>
        </div>

        <!-- Selected Alkene Info -->
        <div id="alkene-info" class="alkene-info">
          <h4>Heat of Hydrogenation</h4>
          <div class="info-row">
            <span>Most Stable:</span>
            <span id="alkene-most-stable">‚Äî</span>
          </div>
          <div class="info-row">
            <span>ŒîH:</span>
            <span id="alkene-most-stable-dh">‚Äî</span>
          </div>
          <div class="info-row">
            <span>Least Stable:</span>
            <span id="alkene-least-stable">‚Äî</span>
          </div>
          <div class="info-row">
            <span>ŒîH:</span>
            <span id="alkene-least-stable-dh">‚Äî</span>
          </div>
          <div class="info-row highlight">
            <span>Stability Difference:</span>
            <span id="alkene-diff">‚Äî</span>
          </div>
        </div>

        <!-- Explanation -->
        <div id="alkene-explanation" class="alkene-explanation">
          <h4>Why More Substituted = More Stable?</h4>
          <ul class="explanation-list">
            <li><strong>Hyperconjugation:</strong> Alkyl C-H œÉ bonds overlap with œÄ* orbital</li>
            <li>More substituents = more hyperconjugation = more stable</li>
            <li><strong>E vs Z:</strong> Trans (E) is more stable due to less steric strain</li>
          </ul>
        </div>

        <!-- Alkene Quiz Panel -->
        <div id="alkene-quiz-panel" class="energy-quiz-panel hidden">
          <div class="quiz-header">
            <h4>Alkene Stability Quiz</h4>
            <div class="quiz-score">Score: <span id="alkene-quiz-score">0/0</span></div>
          </div>
          <div class="quiz-question-area">
            <p id="alkene-quiz-question" class="quiz-question">Click "New Question" to start!</p>
            <div id="alkene-quiz-options" class="quiz-options"></div>
            <div id="alkene-quiz-feedback" class="quiz-feedback hidden"></div>
          </div>
          <div class="quiz-actions">
            <button id="alkene-new-question-btn" class="primary-btn">New Question</button>
            <button id="alkene-submit-btn" class="primary-btn" disabled>Submit</button>
          </div>
        </div>
      </div>

      <!-- Stereochemistry Tracker Panel -->
      <div id="stereo-panel" class="energy-display hidden">
        <h3>Stereochemistry</h3>

        <!-- SMILES Analysis Result -->
        <div id="stereo-smiles-result" class="smiles-result hidden">
          <h4>Your Molecule Analysis</h4>
          <div class="smiles-result-content">
            <div class="info-row">
              <span>Structure:</span>
              <span id="stereo-result-smiles" class="mono">‚Äî</span>
            </div>
            <div class="info-row">
              <span>Stereocenters:</span>
              <span id="stereo-result-centers">‚Äî</span>
            </div>
            <div class="info-row">
              <span>Leaving Groups:</span>
              <span id="stereo-result-lg">‚Äî</span>
            </div>
            <div class="info-row highlight">
              <span>SN2 Outcome:</span>
              <span id="stereo-result-sn2">‚Äî</span>
            </div>
            <div class="info-row">
              <span>SN1 Outcome:</span>
              <span id="stereo-result-sn1">‚Äî</span>
            </div>
            <div id="stereo-result-explanation" class="result-explanation"></div>
          </div>
        </div>

        <!-- Outcome Summary -->
        <div id="stereo-outcome" class="stereo-outcome">
          <h4>Reaction Outcome</h4>
          <div class="outcome-row">
            <span>Starting Config:</span>
            <span id="stereo-start-config" class="config-badge">‚Äî</span>
          </div>
          <div class="outcome-row">
            <span>Product Config:</span>
            <span id="stereo-end-config" class="config-badge">‚Äî</span>
          </div>
          <div class="outcome-row highlight">
            <span>Result:</span>
            <span id="stereo-result">‚Äî</span>
          </div>
        </div>

        <!-- Explanation -->
        <div id="stereo-explanation" class="stereo-explanation">
          <h4>Key Points</h4>
          <ul id="stereo-explanation-list" class="explanation-list">
            <li>Select a mode to see stereochemistry concepts</li>
          </ul>
        </div>

        <!-- Stereo Quiz Panel -->
        <div id="stereo-quiz-panel" class="energy-quiz-panel hidden">
          <div class="quiz-header">
            <h4>Stereochemistry Quiz</h4>
            <div class="quiz-score">Score: <span id="stereo-quiz-score">0/0</span></div>
          </div>
          <div class="quiz-question-area">
            <p id="stereo-quiz-question" class="quiz-question">Click "New Question" to start!</p>
            <div id="stereo-quiz-options" class="quiz-options"></div>
            <div id="stereo-quiz-feedback" class="quiz-feedback hidden"></div>
          </div>
          <div class="quiz-actions">
            <button id="stereo-new-question-btn" class="primary-btn">New Question</button>
            <button id="stereo-submit-btn" class="primary-btn" disabled>Submit</button>
          </div>
        </div>
      </div>

      <!-- Mechanism Animator Panel -->
      <div id="mechanism-panel" class="energy-display hidden">
        <h3>Mechanism Details</h3>

        <!-- Mechanism Info -->
        <div id="mechanism-info" class="mechanism-info">
          <div class="mechanism-name">
            <span id="mechanism-name-display">SN2 - Nucleophilic Substitution</span>
          </div>
          <div class="mechanism-type-badge" id="mechanism-type-badge">
            Substitution
          </div>
        </div>

        <!-- Current Step Info -->
        <div id="mechanism-step-info" class="mechanism-step-info">
          <h4>Current Step</h4>
          <div class="step-title" id="mechanism-step-title">Backside Attack</div>
          <div class="step-description" id="mechanism-step-description">
            Nucleophile attacks carbon 180¬∞ from leaving group
          </div>
        </div>

        <!-- Key Points -->
        <div id="mechanism-key-points" class="mechanism-key-points">
          <h4>Key Points</h4>
          <ul id="mechanism-points-list" class="explanation-list">
            <li>Rate = k[substrate][nucleophile]</li>
            <li>Complete inversion of configuration</li>
            <li>Favored by strong nucleophile</li>
          </ul>
        </div>

        <!-- Products -->
        <div id="mechanism-products" class="mechanism-products">
          <h4>Products</h4>
          <div id="mechanism-products-list" class="products-list">
            <span class="product-item">Alcohol (inverted)</span>
            <span class="product-item">Br‚Åª</span>
          </div>
        </div>

        <!-- Mechanism Quiz Panel -->
        <div id="mechanism-quiz-panel" class="energy-quiz-panel hidden">
          <div class="quiz-header">
            <h4>Mechanism Quiz</h4>
            <div class="quiz-score">Score: <span id="mechanism-quiz-score">0/0</span></div>
          </div>
          <div class="quiz-question-area">
            <p id="mechanism-quiz-question" class="quiz-question">Click "New Question" to start!</p>
            <div id="mechanism-quiz-options" class="quiz-options"></div>
            <div id="mechanism-quiz-feedback" class="quiz-feedback hidden"></div>
          </div>
          <div class="quiz-actions">
            <button id="mechanism-new-question-btn" class="primary-btn">New Question</button>
            <button id="mechanism-submit-btn" class="primary-btn" disabled>Submit</button>
          </div>
        </div>
      </div>

      <div id="energy-panel" class="energy-display chair-only">
        <h3>Energy Analysis</h3>
        <div class="energy-chart">
          <div class="energy-bar-row">
            <span class="bar-label">Current</span>
            <div class="bar-container">
              <div id="bar-current" class="energy-bar current"></div>
            </div>
            <span id="bar-current-value" class="bar-value">0.00</span>
          </div>
          <div class="energy-bar-row">
            <span class="bar-label">Flipped</span>
            <div class="bar-container">
              <div id="bar-flipped" class="energy-bar flipped"></div>
            </div>
            <span id="bar-flipped-value" class="bar-value">0.00</span>
          </div>
          <div class="chart-scale">
            <span>0</span>
            <span>kcal/mol</span>
            <span id="chart-max">10</span>
          </div>
        </div>
        <div class="energy-row highlight">
          <span>ŒîE:</span>
          <span id="energy-delta">0.00 kcal/mol</span>
        </div>
        <div class="energy-row">
          <span>Preferred:</span>
          <span id="preferred-chair">Neither</span>
        </div>
      </div>

      <div id="decalin-energy-panel" class="energy-display hidden">
        <h3>Decalin Info</h3>
        <div class="energy-row">
          <span>Relative Stability:</span>
          <span id="decalin-stability">Most stable</span>
        </div>
        <div class="energy-row">
          <span>vs other isomer:</span>
          <span id="decalin-delta">‚Äî</span>
        </div>
      </div>

      <div class="substituents-list chair-only">
        <h3>Substituents</h3>
        <ul id="substituent-list">
          <li class="empty-message">Click a position on the chair to add substituents</li>
        </ul>
      </div>
    </aside>
  </main>

  <!-- Substituent Picker Modal -->
  <div id="substituent-picker" class="picker-modal hidden">
    <div class="picker-content">
      <h4>Select Position & Substituent</h4>
      <div class="position-selector">
        <button class="position-btn" data-position="axial">Axial</button>
        <button class="position-btn" data-position="equatorial">Equatorial</button>
      </div>
      <select id="substituent-select">
        <option value="H">H (Hydrogen)</option>
        <option value="CH3">CH‚ÇÉ (Methyl)</option>
        <option value="C2H5">C‚ÇÇH‚ÇÖ (Ethyl)</option>
        <option value="iPr">iPr (Isopropyl)</option>
        <option value="tBu">tBu (tert-Butyl)</option>
        <option value="Ph">Ph (Phenyl)</option>
        <option value="OH">OH (Hydroxyl)</option>
        <option value="OCH3">OCH‚ÇÉ (Methoxy)</option>
        <option value="F">F (Fluorine)</option>
        <option value="Cl">Cl (Chlorine)</option>
        <option value="Br">Br (Bromine)</option>
        <option value="I">I (Iodine)</option>
        <option value="CN">CN (Cyano)</option>
        <option value="NO2">NO‚ÇÇ (Nitro)</option>
        <option value="NH2">NH‚ÇÇ (Amino)</option>
        <option value="COOH">COOH (Carboxyl)</option>
      </select>
      <div class="picker-actions">
        <button id="add-substituent-btn">Add</button>
        <button id="remove-substituent-btn">Remove</button>
        <button id="cancel-picker-btn">Cancel</button>
      </div>
    </div>
  </div>

  <script type="module" src="js/app.js"></script>
</body>
</html>
